VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Form_Produtos"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Private Sub Delete()
On Error GoTo tratar
If Me.txtId = 0 Then Exit Sub
Dim context As New Contexto
If MsgBox("Deseja realmente excluir registro?", vbYesNo, "Atenção") = vbYes Then
    Call context.Produtos.Delete(Me.txtId)
    MsgBox "Excluído com sucesso.", , "Atenção"
    Call CarregarModelo(0)
End If
Exit Sub
tratar:
MsgBox Err.Description, , "Erro"
End Sub

Private Sub cmdSair_Click()
    DoCmd.Close acForm, Me.Name
End Sub

Private Sub Form_Load()
    If Len(Me.OpenArgs & "") > 0 Then
        Call CarregarModelo(Me.OpenArgs)
    Else
        Call CarregarModelo(0)
    End If
    
    Dim context As New Contexto
    Me.lst.RowSource = context.Produtos.ListToString("Id,Nome", "Order by Nome", True)
End Sub
Private Sub Limpar()
    Call CarregarModelo(0)
End Sub
Private Sub CarregarModelo(Id As Integer)
On Error GoTo tratar
Dim m As Produtos
Dim context As New Contexto
If Id = 0 Then
    Set m = New Produtos
Else
    Set m = context.Produtos.Model(Id)
End If
'
        Me.txtId = m.Id
        Me.txtNome = m.Nome
        Me.txtUnidadeMedida = m.UnidadeMedida
        Me.txtDataCadastro = m.DataCadastro
        Me.txtValorProduto = m.ValorProduto
Exit Sub
tratar:
MsgBox Err.Description, , "Atenção"
End Sub
Private Function Modelo() As Produtos
On Error GoTo tratar
Dim m As New Produtos
If Me.txtId > 0 Then
    m.Id = Me.txtId

End If

        m.Id = Me.txtId & ""
        m.Nome = Me.txtNome & ""
        m.UnidadeMedida = Me.txtUnidadeMedida & ""
        m.DataCadastro = Me.txtDataCadastro & ""
        m.ValorProduto = Me.txtValorProduto & ""
Set Modelo = m
Exit Function
tratar:
MsgBox Err.Description, , "Erro"
End Function
Private Sub Salvar()
On Error GoTo tratar
Dim context As New Contexto
If Valido Then
    If Me.txtId = 0 Then
        Call context.Produtos.Add(Modelo)
    Else
        Call context.Produtos.Update(Modelo)
    End If
    MsgBox "Salvo com sucesso.", , "Sucesso"
    Call CarregarModelo(0)
End If
Exit Sub
tratar:
MsgBox Err.Description, , "Erro"
End Sub
Private Function Valido() As Boolean
Valido = True
End Function

Private Sub cmdExcluir_Click()
    Call Delete
End Sub

Private Sub cmdLimpar_Click()
    Call Limpar
End Sub

Private Sub cmdSalvar_Click()
    Call Salvar
End Sub

Private Sub lst_Click()
    Call CarregarModelo(Me.lst.Column(0))
End Sub
